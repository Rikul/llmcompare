<!-- Response Template - Include this in your main template -->
<!-- This template can be used as a component for displaying individual model responses -->

<div class="response-card bg-white rounded-lg shadow-md p-6 mb-4" data-model-id="{{ model_id }}">
    <!-- Response Header -->
    <div class="response-header flex justify-between items-center mb-4">
        <div class="model-info">
            <h3 class="text-lg font-semibold text-gray-800">{{ model_name }}</h3>
            <p class="text-sm text-gray-500">{{ provider }}</p>
        </div>
        
        <div class="response-actions flex items-center space-x-2">
            <!-- Status Indicator -->
            <span class="status-indicator flex items-center text-sm">
                {% if status == 'success' %}
                    <span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                    <span class="text-green-600">Success</span>
                {% elif status == 'error' %}
                    <span class="w-2 h-2 bg-red-500 rounded-full mr-2"></span>
                    <span class="text-red-600">Error</span>
                {% else %}
                    <span class="w-2 h-2 bg-yellow-500 rounded-full mr-2"></span>
                    <span class="text-yellow-600">Loading</span>
                {% endif %}
            </span>
        </div>
    </div>

    <!-- Response Content -->
    <div class="response-content relative">
        {% if status == 'loading' %}
            <!-- Loading State -->
            <div class="flex items-center justify-center py-12">
                <div class="loading-spinner ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12 border-t-purple-600 animate-spin"></div>
                <span class="ml-3 text-gray-600">Generating response...</span>
            </div>
        {% elif status == 'error' %}
            <!-- Error State -->
            <div class="bg-red-50 border-l-4 border-red-400 p-4 rounded">
                <div class="flex">
                    <div class="flex-shrink-0">
                        <svg class="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <div class="ml-3">
                        <h3 class="text-sm font-medium text-red-800">Error</h3>
                        <p class="text-sm text-red-700 mt-1">{{ error_message }}</p>
                        {% if error_type == 'missing_api_key' %}
                            <p class="text-xs text-red-600 mt-2">Please add the API key to your .env file</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% else %}
            <!-- Success State -->
            <div class="response-text-container bg-gray-50 rounded-lg p-4 relative">
                <pre class="response-text whitespace-pre-wrap text-gray-700 text-sm" id="response-{{ model_id }}">{{ response_text }}</pre>
                
                <!-- Copy Button -->
                <button 
                    class="copy-button absolute top-2 right-2 bg-white px-3 py-1 rounded-md border border-gray-300 text-xs text-gray-600 hover:bg-gray-50 transition-colors"
                    onclick="copyResponse('{{ model_id }}')"
                >
                    <svg class="w-4 h-4 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                    </svg>
                    Copy
                </button>
            </div>

            <!-- Response Metadata -->
            <div class="response-metadata mt-4 flex justify-between items-center text-xs text-gray-500">
                <div class="timestamp">
                    <svg class="w-4 h-4 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    {{ timestamp }}
                </div>
                
                {% if usage %}
                <div class="usage-info">
                    {% if usage.prompt_tokens %}
                        <span class="mr-3">Prompt: {{ usage.prompt_tokens }} tokens</span>
                    {% endif %}
                    {% if usage.completion_tokens %}
                        <span>Response: {{ usage.completion_tokens }} tokens</span>
                    {% endif %}
                </div>
                {% endif %}
            </div>
        {% endif %}
    </div>
</div>

<style>
/* Response-specific styles */
.response-card {
    transition: all 0.3s ease;
}

.response-card:hover {
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
}

.copy-button.copied {
    background-color: #10b981;
    color: white;
    border-color: #10b981;
}

.copy-button.copied svg {
    display: none;
}

.copy-button.copied::before {
    content: "✓";
    margin-right: 4px;
}

/* Loading spinner animation */
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.animate-spin {
    animation: spin 1s linear infinite;
}

/* Response text formatting */
.response-text {
    max-height: 400px;
    overflow-y: auto;
    line-height: 1.6;
}

.response-text::-webkit-scrollbar {
    width: 6px;
}

.response-text::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 3px;
}

.response-text::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 3px;
}

.response-text::-webkit-scrollbar-thumb:hover {
    background: #555;
}
</style>

<script>
// Copy response function
function copyResponse(modelId) {
    const responseText = document.getElementById(`response-${modelId}`).textContent;
    navigator.clipboard.writeText(responseText).then(function() {
        // Find the copy button and update its state
        const button = event.target.closest('.copy-button');
        button.classList.add('copied');
        button.innerHTML = '<span>✓ Copied</span>';
        
        // Reset button after 2 seconds
        setTimeout(() => {
            button.classList.remove('copied');
            button.innerHTML = `
                <svg class="w-4 h-4 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                </svg>
                Copy
            `;
        }, 2000);
    }).catch(function(err) {
        console.error('Failed to copy text: ', err);
        alert('Failed to copy text');
    });
}
</script>